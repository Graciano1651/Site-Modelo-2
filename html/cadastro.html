<!DOCTYPE html>
<html lang="pt-BR">
<head>
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cadastro de Funcionário</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
   <div class="container">
    <div class="content">
     <form id="employeeForm" class="form-grid">
        <button type="button" id="clearBtn" class="btn btn-warning">
          <i class="fas fa-eraser"></i> Limpar
        </button>

        <button id="newUserBtn" class="btn btn-info" style="display:none; margin-top: 1rem;">
          <i class="fas fa-user-plus"></i> Novo Funcionário
        </button>
      </form>
    </div>
  </div>

  <!-- Verificação de admin e carregamento dinâmico do form.js -->
  <script type="module">
    import { getCurrentUser } from '../js/utils.js';

    document.addEventListener('DOMContentLoaded', async () => {
      const user = await getCurrentUser();

      if (!user?.is_admin) {
        alert("Acesso não autorizado. Redirecionando...");
        window.location.href = "dashboard.html";
        return;
      }

      // Carregar form.js apenas para admin
      const script = document.createElement('script');
      script.src = '../js/form.js';
      document.body.appendChild(script);
    });
  </script>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // Configura datepicker para campos de data
    flatpickr("#hire_date", {
      dateFormat: "Y-m-d",
      allowInput: true
    });

    // Configura tema
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark');
    }

    document.getElementById('themeToggle').addEventListener('click', () => {
      document.body.classList.toggle('dark');
      localStorage.setItem('darkMode', document.body.classList.contains('dark'));
    });
  });
</script>

  <!-- Suporte ao modo escuro (darkMode) -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark');
      }

      document.getElementById('themeToggle')?.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        localStorage.setItem('darkMode', document.body.classList.contains('dark'));
      });
    });
  </script>
</body>
</html>
